<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technician Report</title>
    <style>
        /* Basic styling for better appearance */
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            max-width: 500px;
        }
        label {
            margin-top: 10px;
            display: block;
        }
        input[type="text"], input[type="number"] {
            width: calc(100% - 22px);
            padding: 10px;
            margin: 5px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            padding: 10px;
            margin-top: 5px;
            border: none;
            background-color: #007BFF;
            color: white;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <h1>Technician Report</h1>
    <form id="reportForm">
        <label for="workOrderNumber">Work Order Number:</label>
        <input type="text" id="workOrderNumber" readonly><br>

        <label for="workStartTime">Work Start Time:</label>
        <input type="text" id="workStartTime" required>
        <button type="button" onclick="selectTime('workStartTime')">Select Time</button><br>

        <label for="workEndTime">Work End Time:</label>
        <input type="text" id="workEndTime" required>
        <button type="button" onclick="selectTime('workEndTime')">Select Time</button><br>

        <label for="travelStartTime">Travel Start Time:</label>
        <input type="text" id="travelStartTime" required>
        <button type="button" onclick="selectTime('travelStartTime')">Select Time</button><br>

        <label for="travelEndTime">Travel End Time:</label>
        <input type="text" id="travelEndTime" required>
        <button type="button" onclick="selectTime('travelEndTime')">Select Time</button><br>

        <label for="kmStart">KM Start:</label>
        <input type="number" id="kmStart" required><br>

        <label for="kmEnd">KM End:</label>
        <input type="number" id="kmEnd" required><br>

        <button type="submit">Submit Report</button>
    </form>

    <script>
        function generateWorkOrderNumber() {
            const now = new Date();
            return `${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}`;
        }

        function displayWorkOrderNumber() {
            document.getElementById("workOrderNumber").value = generateWorkOrderNumber();
        }

        function selectTime(inputId) {
            const time = prompt("Enter time (HH:MM in Military Time):");
            if (time) {
                document.getElementById(inputId).value = time;
            }
        }

        function submitForm(event) {
            event.preventDefault(); // Prevent form from submitting the default way
            
            const formData = {
                workOrderNumber: document.getElementById("workOrderNumber").value,
                workStartTime: document.getElementById("workStartTime").value,
                workEndTime: document.getElementById("workEndTime").value,
                travelStartTime: document.getElementById("travelStartTime").value,
                travelEndTime: document.getElementById("travelEndTime").value,
                kmStart: document.getElementById("kmStart").value,
                kmEnd: document.getElementById("kmEnd").value
            };

            // Convert to CSV format
            const csvData = `Work Order Number,Work Start Time,Work End Time,Travel Start Time,Travel End Time,KM Start,KM End\n${formData.workOrderNumber},${formData.workStartTime},${formData.workEndTime},${formData.travelStartTime},${formData.travelEndTime},${formData.kmStart},${formData.kmEnd}\n`;

            // Create a blob and download the CSV
            const blob = new Blob([csvData], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.setAttribute('download', 'technician_report.csv');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            // Reset form after submission
            document.getElementById("reportForm").reset(); 
            displayWorkOrderNumber(); // Regenerate work order number for the next submission
        }

        // Initialize work order number on page load
        window.onload = displayWorkOrderNumber;
        document.getElementById("reportForm").onsubmit = submitForm; // Attach the submit function
    </script>
</body>
</html>
