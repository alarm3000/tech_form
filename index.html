<!DOCTYPE html>
<html>
<head>
    <title>Technician Report Form</title>
</head>
<body>
    <h1>Technician Report</h1>
    <form id="reportForm">
        <label for="workOrderNumber">Work Order Number:</label>
        <input type="text" id="workOrderNumber" readonly><br><br>

        <label for="startTime">Start Time (Military Time):</label>
        <input type="text" id="startTime" required><br><br>

        <label for="endTime">End Time (Military Time):</label>
        <input type="text" id="endTime" required><br><br>

        <label for="kmStart">KM Start:</label>
        <input type="number" id="kmStart" required><br><br>

        <label for="kmEnd">KM End:</label>
        <input type="number" id="kmEnd" required><br><br>

        <label for="notes">Notes:</label><br>
        <textarea id="notes" rows="4" cols="50"></textarea><br><br>

        <label for="address">Address:</label>
        <input type="text" id="address" required><br><br>

        <label for="equipment">Equipment Used:</label>
        <input type="text" id="equipment" required><br><br>

        <label for="partUsed">Part Used:</label>
        <select id="partUsed">
            <option value="Yes">Yes</option>
            <option value="No">No</option>
        </select><br><br>

        <label for="techName">Technician Name:</label>
        <input type="text" id="techName" required><br><br>

        <button type="button" onclick="submitForm()">Submit</button>
    </form>

    <script>
        function generateWorkOrderNumber() {
            const now = new Date();
            return `${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}`;
        }

        function displayWorkOrderNumber() {
            document.getElementById("workOrderNumber").value = generateWorkOrderNumber();
        }

        function submitForm() {
            const formData = {
                workOrderNumber: document.getElementById("workOrderNumber").value,
                startTime: document.getElementById("startTime").value,
                endTime: document.getElementById("endTime").value,
                kmStart: document.getElementById("kmStart").value,
                kmEnd: document.getElementById("kmEnd").value,
                notes: document.getElementById("notes").value,
                address: document.getElementById("address").value,
                equipment: document.getElementById("equipment").value,
                partUsed: document.getElementById("partUsed").value,
                techName: document.getElementById("techName").value,
            };

            fetch('https://script.google.com/macros/s/AKfycbyS5M4MS0psscygs3w7gkMzfRkpxpeQpeSq1tZMoThm9jtutcJ0zw4eKwLgDCSrsqgY/exec', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(formData)
            })
            .then(response => {
                if (response.ok) {
                    alert('Report submitted successfully!');
                    document.getElementById("reportForm").reset(); // Reset the form after submission
                    displayWorkOrderNumber(); // Regenerate work order number for the next submission
                } else {
                    alert('Error submitting the report. Please try again.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('An error occurred. Please try again later.');
            });
        }

        // Initialize work order number on page load
        window.onload = displayWorkOrderNumber;
    </script>
</body>
</html>
